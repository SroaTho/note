# AD 证书颁发机构

# 角色描述

Windows Server 2016 中的 AD CS 提供可自定义的服务，用于创建和管理在采用公钥技术的软件安全系统中使用的 x.509 证书。

# 服务器管理器信息

![image-20230216133539595](images/CA%E8%AF%81%E4%B9%A6%E9%A2%81%E5%8F%91%E6%9C%BA%E6%9E%84.assets/image-20230216133539595.png)

# 证书颁发机构指南

证书颁发机构 （CA） 负责证明用户、计算机和组织的身份。CA 通过颁发数字签名证书对实体进行身份验证并担保该身份。CA 还可以管理、吊销和续订证书。

# 选择设置类型

**企业 CA** 与 AD域 集成。他们将证书和证书吊销列表 （CRL） 发布到 AD DS。企业 CA 使用 AD DS 中存储的信息（包括用户帐户和安全组）来批准或拒绝证书请求。企业 CA 使用证书模板。颁发证书时，企业 CA 使用证书模板中的信息生成具有该证书类型的相应属性的证书。

**独立 CA** 不需要 AD DS，并且不使用证书模板。如果使用独立 CA，则证书请求中必须包含有关所请求证书类型的所有信息。默认情况下，提交到独立 CA 的所有证书请求都保留在挂起队列中，直到 CA 管理员批准它们。您可以将独立 CA 配置为根据请求自动颁发证书，但这不太安全，通常不建议这样做，因为请求未经过身份验证。

# 选择CA类型

企业和独立 CA 可以配置为根 CA 或从属 CA。从属 CA 可以进一步配置为中间 CA（也称为策略 CA）或颁发 CA

注意：根CA是信任的源头，管理下级CA，即是从属CA。

# 指定根 CA

根 CA 是位于证书层次结构顶部的 CA。组织中的客户必须无条件信任它。所有证书链都终止于根 CA。无论使用企业 CA 还是独立 CA，都需要指定根 CA。

# 从属CA

不是根 CA 的 CA 被视为从属 CA。层次结构中的第一个从属 CA 从根 CA 获取其 CA 证书。第一个从属 CA 可以使用此密钥颁发证书，以验证另一个从属 CA 的完整性。这些较高的从属 CA 称为中间 CA。中间 CA 从属于根 CA，但它充当一个或多个从属 CA 的更高证书颁发机构。

中间 CA 通常称为策略 CA，因为它通常用于分隔可由策略区分的证书类。例如，策略分离包括 CA 提供的保证级别或 CA 用于区分不同最终实体群体的地理位置。策略 CA 可以联机或脱机。

# 建立 CA 名称

在组织中配置证书颁发机构 （CA） 之前，应建立 CA 命名约定。

在 Active Directory 域服务 （AD DS） 中，将服务器配置为 CA 时指定的名称将成为 CA 的公用名，并且此名称将反映在 CA 颁发的每个证书中。

# 获取证书请求

安装根证书颁发机构 （CA） 后，许多组织将安装一个或多个从属 CA，以对公钥基础结构 （PKI） 实施策略限制并向最终客户端颁发证书。使用至少一个从属 CA 有助于保护根 CA 免受不必要的暴露。安装从属 CA 时，必须从父 CA 获取证书。

如果父 CA 处于联机状态，则可以使用“**向父 CA 发送证书请求**”选项，并按 CA 名称或计算机名称选择父 CA。

如果父 CA 处于脱机状态，则应使用“**将证书请求保存到目标计算机上的文件**”选项。此过程对于父 CA 是唯一的。父 CA 至少应提供一个文件，其中包含从属 CA 新颁发的证书，最好是其完整证书路径。

# 验证有效期

每个证书都有有效期。有效期结束后，证书不再被视为可接受或可用的凭据。

 CA 不能颁发超过其自身有效期的证书。最佳做法是在 CA 证书的一半有效期到期时续订该证书。安装 CA 时，应计划此日期并确保将其记录为将来的任务。

# 配置 CA

​		安装根或从属 CA 后，必须在 CA 颁发任何证书之前配置颁发机构信息访问 （AIA） 和 CRL 分发点 （CDP） 扩展。AIA 扩展指定在何处查找 CA 的最新证书。CDP 扩展指定在何处查找由 CA 签名的最新 CRL。这些扩展适用于该 CA 颁发的所有证书。

​		配置这些扩展可确保此信息包含在 CA 颁发的每个证书中，以便所有客户端都可以使用。这可确保 PKI 客户端由于未经验证的证书链或证书吊销而遇到的失败次数尽可能少，这可能导致 VPN 连接失败、智能卡登录失败或电子邮件签名未经验证。

​		作为 CA 管理员，你可以添加、删除或修改 CRL 分发点以及 CDP 和 AIA 证书颁发的位置。修改 CRL 分发点的 URL 仅影响新颁发的证书。以前颁发的证书将继续引用原始位置，这就是您应该在 CA 分发任何证书之前建立这些位置的原因。





