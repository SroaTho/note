# 基础

## 传入参数

`import sys`

读取命令行参数，把脚本名与其他参数转化为字符串列表存到 `sys` 模块的 `argv` 变量里。

该列表最少有一个元素；未给定输入参数时，sys.argv[0] 是空字符串。给定脚本名是 '-' （标准输入）时，sys.argv[0] 是 '-'。

使用 -c command 时，sys.argv[0] 是 '-c'。

如果使用选项 -m module，sys.argv[0] 就是包含目录的模块全名。、

解释器不处理 -c command 或 -m module 之后的选项，而是直接留在 sys.argv 中由命令或模块来处理。





## 编码

Python 源码文件的默认编码是 UTF-8，如果不使用默认编码，则要声明文件的编码。

```python
# -*- coding: encoding -*-
```

encoding 可以是 Python 支持的任意一种 codecs，例如：

```python
# -*- coding: cp1252 -*-
```



如果源码以 UNIX "shebang" 行 开头，编码声明要写在文件的第二行：

```python
#!/usr/bin/env python3
# -*- coding: cp1252 -*-
```



## 数学运算

表达式语法很直观：运算符 +, -, * 和 / 可被用来执行算术运算；圆括号 (()) 可被用来进行分组。

```python
>>> 2 + 2
4
>>> 50 - 5*6
20
```

整数（如，2、4、20 ）的类型是 int

带小数（如，5.0、1.6 ）的类型是 float



除法运算 (/) 总是返回浮点数。 

`//` 运算符返回整数的姐结果。

`%`运算符返回余数。

 `**` 运算符计算乘方。



## 变量

等号（`=`）用于给变量赋值。

```python
>>> width = 200
>>> height = 5 * 9
>>> width * height
900
```



如果变量未定义（即，未赋值），使用该变量会提示错误：

```python
>>> n  # try to access an undefined variable
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
NameError: name 'n' is not defined
```



## 文本

用双引号`"`或单引号`'`包裹起来的字符，结果完全相同，称为字符串：

```python
>>> 'spam eggs'  # single quotes
'spam eggs'
>>> "Paris rabbit got your back :)! Yay!"  # double quotes
'Paris rabbit got your back :)! Yay!'
```



### 转义字符

要标示引号本身，我们需要对它进行“转义”，即在前面加一个 `\`，也可以使用不同类型的引号：

```python
>>> 'doesn\'t'  # use \' to escape the single quote...
"doesn't"
>>> "doesn't"  # ...or use double quotes instead
"doesn't"
```



字符串定义和`print()`函数输出字符串，并打印经过转义的特殊字符：

```python
>>> s = 'First line.\nSecond line.'  # \n means newline
>>> s  # without print(), special characters are included in the string
'First line.\nSecond line.'
>>> print(s)  # with print(), special characters are interpreted, so \n produces new line
First line.
Second line.
```



如果不希望前置 \ 的字符转义成特殊字符，可以使用**原始字符串**（不能以奇数个 `\` 字符结束），在引号前添加 r 即可：

```python
>>> print('C:\some\name')  # here \n means newline!
C:\some
ame
>>> print(r'C:\some\name')  # note the r before the quote
C:\some\name
```



三重引号：`"""..."""` 或 `'''...'''`，字符串中将自动包括行结束符，但也可以在换行的地方添加一个 `\` 来避免：

```python
print("""\
Usage: thingy [OPTIONS]
     -h                        Display this usage message
     -H hostname               Hostname to connect to
""")
```

输出如下（请注意开始的换行符没有被包括在内）：

```
Usage: thingy [OPTIONS]
     -h                        Display this usage message
     -H hostname               Hostname to connect to
```



## 字符串拼接

字符串可以用 `+` 合并（粘到一起），也可以用 `*` 重复：

```python
>>> # 3 times 'abc', followed by '123'
>>> 3 * 'abc' + '123'
'abcabcabc123'
```



相邻的两个或多个 **字符串字面值** （引号标注的字符）会自动合并：

```python
>>> 'Py' 'thon'
'Python'
```



拼接分隔开的长字符串时（只能用于两个字面值，不能用于变量或表达式：）：

```python
>>> text = ('Put several strings within parentheses '
        'to have them joined together.')

>>> text
'Put several strings within parentheses to have them joined together.'
```



合并多个变量，或合并变量与字面值，要用 +：

```python
>>> prefix + 'thon'
'Python'
```



## 字符串索引

```
 +---+---+---+---+---+---+
 | P | y | t | h | o | n |
 +---+---+---+---+---+---+
 0   1   2   3   4   5   6
-6  -5  -4  -3  -2  -1
```

字符串支持 索引 （下标访问），第一个字符的索引是 0。

索引还支持负数，用负数索引时，从右边开始计数。

注意，-0 和 0 一样，因此，负数索引从 -1 开始。

```python
>>> str = "python"
>>> str[0]
'p'
>>> str[-0]
'p'
>>> str[1]
'y'
>>> str[-1]
'n'
```



## 字符串切片

切片允许你获取子字符串：

```python
>>> word[0:2]
'py'
>>> word[2:5]
'tho'
```

切片索引的默认值很有用；省略开始索引时，默认值为 0，省略结束索引时，默认为到字符串的结尾：

```python
>>> word[:2]
'py'
>>> word[4:]
'on'
>>> word[-2:]
'on'
```

注意，输出结果包含切片开始，但不包含切片结束。

因此，s[:i] + s[i:] 总是等于 s：

```python
>>> word[:2] + word[2:]
'Python'
>>> word[:4] + word[4:]
'Python'
```



索引越界会报错：

```python
>>> word[42]  # the word only has 6 characters
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
IndexError: string index out of range
```



切片会自动处理越界索引：

```python
>>> word[4:42]
'on'
>>> word[42:]
''
```



Python 字符串不能修改，是 immutable 的。因此，为字符串中某个索引位置赋值会报错：

```python
>>> word[0] = 'J'
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: 'str' object does not support item assignment
>>> word[2:] = 'py'
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: 'str' object does not support item assignment
```



要生成不同的字符串，应新建一个字符串：

```python
>>> 'J' + word[1:]
'Jython'
>>> word[:2] + 'py'
'Pypy'
```



内置函数 len() 返回字符串的长度：

```python
>>> s = 'supercalifragilisticexpialidocious'
len(s)
34
```



## 列表

Python 支持多种 复合 数据类型，可将不同值组合在一起，列表也支持索引和切片，其内容可以改变。

最常用的 列表 ，是用方括号标注，逗号分隔的一组值，一般情况下，各个元素的类型相同：

```python
>>> squares = [1, 4, 9, 16, 25]
>>> squares
[1, 4, 9, 16, 25]
```



列表还支持合并操作：

```python
>>> squares + [36, 49, 64, 81, 100]
[1, 4, 9, 16, 25, 36, 49, 64, 81, 100]
```



list.append() 方法，在列表末尾添加新条目：

```python
>>> cubes.append(216)  # add the cube of 6
>>> cubes.append(7 ** 3)  # and the cube of 7
>>> cubes
[1, 8, 27, 64, 125, 216, 343]
```



当你将一个列表赋值给一个变量时，该变量将引用 现有的列表

```python
>>> rgb = ["Red", "Green", "Blue"]
>>> rgba = rgb
>>> id(rgb) == id(rgba)  # they reference the same object
True
>>> rgba.append("Alph")
>>> rgb
["Red", "Green", "Blue", "Alph"]
```



内置函数 len() 也支持列表：

```python
>>> letters = ['a', 'b', 'c', 'd']
>>> len(letters)
4
```



### 嵌套列表

嵌套列表（创建包含其他列表的列表）：

```python
>>> a = [ [1,2,3] , [4,5,6,7] , ['a','b',c] ]
>>> a
[ [1,2,3] , [4,5,6,7] , ['a','b',c] ]

>>> a[1]
[1,2,3]

>>> a[2]
[4,5,6,7]
>>> a[2][0]
4

>>> a[3]
['a','b','c']
```



### 引用

当你将一个列表赋值给一个变量时，该变量将引用 现有的列表。

```python
>>> a = [1,2,3]
>>> b = a
>>> a
[1,2,3]
>>> b[2] = 4
>>> a
[1,2,4]
```



### 浅拷贝

创建一个新的复合对象，并将原始对象中找到的引用插入到新对象中。

```python
>>> a = [ [1,2,3] , [4,5,6]]
>>> b = a
>>> a
[ [1,2,3] , [4,5,6]]

>>> b[0] = [3,2,1]
>>> b
[ [3,2,1] , [4,5,6]]
>>> a
[ [1,2,3] , [4,5,6]]

>>> b[1] = [6,5,4]
>>> b
[ [3,2,1] , [6,5,4]]
>>> a
[ [1,2,3] , [6,5,4]]
```



### 深拷贝

创建一个新的复合对象，然后递归地将在原始对象中找到的对象的副本插入到新对象中。

```python
>>> a = [ [1,2,3] , [4,5,6]]
>>> b = copy.deepcopy(a) #深拷贝，对b进行任何操作都无法影响a
>>> a
[ [1,2,3] , [4,5,6]]

>>> b[0] = [3,2,1]
>>> b
[ [3,2,1] , [4,5,6]]
>>> a
[ [1,2,3] , [4,5,6]]

>>> b[1] = [6,5,4]
>>> b
[ [3,2,1] , [6,5,4]]
>>> a
[ [1,2,3] , [4,5,6]]
```



# 控制流

## while

任何非零整数都为真，零为假。

这个条件也可以是字符串或列表类型的值，任何序列都可以：长度非零就为真，空序列则为假。



比较操作符的写法： `<` （小于）、 `>` （大于）、 `==` （等于）、 `<=` （小于等于)、 `>=` （大于等于）及 `!=` （不等于）。



while 循环只要条件（这里是 a < 10）为真就会一直执行。

```python
i = 0
while i < 10:
	print(i)
	i = i + 1
```



## if语句

最让人耳熟能详的语句应当是 if 语句：

```python
if x == 1:
	print("x==1")
else:
	print("x≠1")
```

```python
if x == 1:
	print("x==1")
else:
	if x == 2:
		print("x==2")
	else:
		print("x ≠ 1 & x ≠ 2")
```

关键字 '`elif`' 是 'else if' 的缩写

```python
if x == 1:
	print("x==1")
elif x == 2:
	print("x==2")
else:
	print("x==1 & x==2")
```



## for

Python 的 `for` 语句不迭代算术递增数值（如 Pascal），或是给予用户定义迭代步骤和结束条件的能力。



`for`循环通过`in`关键字来进行迭代。`in`后面的对象通常是一个可迭代对象（如列表、元组、字典、集合或字符串等）。

在每次迭代中，`for`循环都会从可迭代对象中取出一个元素，并将其赋值给在`for`关键字后面定义的变量。

**注意：for使用in进行迭代，不是创建一个对象的副本，而是创建一个引用**

```python
words = ['cat', 'window', 'defenestrate']
for w in words:
    print(w, len(w))
```

```
cat 3
window 6
defenestrate 12
```



如果in的左边有多个变量名，那么Python会尝试将可迭代对象中的元素解包到这些变量中：

```python
users = [['xiaoshae','yes'],['wangwen','no']]

for user,status in users:
    print(user,status)
```



## range函数

内置函数 range() 用于生成等差数列：

```python
for i in range(5):
	print(i)
```

```
0
1
2
3
4
```

生成的序列绝不会包括给定的终止值；

`range(10)` 生成 10 个值——长度为 10 的序列的所有合法索引。



range 可以不从 0 开始，且可以按给定的步长递增（即使是负数步长）：

1. 从5开始到9结束

```python
>>> list(range(5, 10))
[5, 6, 7, 8, 9]
```

2. 从0到9，步长为+3

```python
>>> list(range(0, 10, 3))
[0, 3, 6, 9]
```

3. 从-10到-69，步长-30

```python
>>> list(range(-10, -100, -30))
[-10, -40, -70]
```



要按索引迭代序列，可以组合使用 range() 和 len()：

```python
a = ['Mary', 'had', 'a', 'little', 'lamb']
for i in range(len(a)):
    print(i, a[i])
```

```
0 Mary
1 had
2 a
3 little
4 lamb
```



如果直接打印一个 range 会发生意想不到的事情：

```python
>>> range(10)
range(0, 10)
```

对象只有在被迭代时才一个一个地返回所期望的列表项，称为可迭代对象 iterable，适合作为需要获取一系列值的函数或程序构件的参数：

```python
sum(range(4))  # 0 + 1 + 2 + 3
```

```
6
```



## continue、else、break

for 或 while 循环可以包括 else 子句。

1. for 循环中，else 子句会在循环成功结束最后一次迭代之后执行。
2. while 循环中，它会在循环条件变为假值后执行。

3. 无论哪种循环，如果因为 break 而结束，那么 else 子句就 不会 执行。

4. continue 语句，同样借鉴自 C 语言，以执行循环的下一次迭代来继续。



## pass

pass 语句不执行任何动作。语法上需要一个语句，但程序毋需执行任何动作时，可以使用该语句。

这常用于创建一个最小的类：

```python
>>> class MyEmptyClass:
...     pass
```

用作函数或条件语句体的占位符，让你保持在更抽象的层次进行思考。`pass` 会被默默地忽略：

```python
>>> def initlog(*args):
...     pass   # Remember to implement this!
```



## match

Python 3.10引入了一种新的语法，叫做结构模式匹配（Structural Pattern Matching），也就是我们通常所说的match-case语句

```
match subject:
    case pattern1:
        action1
    case pattern2:
        action2
    ...
    case _:
        default_action
```

1. subject是要匹配的对象
2. pattern是匹配模式
3. action是当模式匹配成功时执行的代码2。



match会按照顺序检查每一个case，并且只会执行第一个匹配成功的case；

一旦找到匹配的case，就会执行相应的代码块，并且跳过后面的所有case；

```python
def http_error(status):
    match status:
        case 400:
            return 'Bad request'
        case 401:
            return 'Unauthorized'
        case 403:
            return 'Forbidden'
        case 404:
            return 'Not found'
        case _:
            return 'Unknown status code'
```



在Python的`match-case`语句中，你可以使用列表（List）作为解包模式。

列表是可变的，需要使用`list()`函数或者方括号`[]`来创建一个新的列表：

```python
point = [1, 2]
match point:
    case [0, y]:
        print(f"Y={y}")
    case [x, 0]:
        print(f"X={x}")
    case [x, y]:
        print(f"X={x}, Y={y}")
    case _:
        raise ValueError("Not a point")
```



# 函数

## 定义函数

定义 函数使用关键字 def，后跟函数名与括号内的形参列表。函数语句从下一行开始，并且必须缩进。

```python
def sum(n):
	list = []
	for i in range(n):
		list.append(i)
	return list
```



当一个函数调用另外一个函数时，会为该调用创建一个新的局部符号表。

实参是使用 按值调用 来传递的（其中的 值 始终是对象的 引用 而不是对象的值）。

函数在 执行 时使用函数局部变量符号表，所有函数变量赋值都存在局部符号表中；

引用变量时，首先，在局部符号表里查找变量，然后，是外层函数局部符号表，再是全局符号表，最后是内置名称符号表。

注意：尽管可以引用全局变量和外层函数的变量，但最好不要在函数内直接赋值（除非是 global 语句定义的全局变量，或 nonlocal 语句定义的外层函数变量）。



以使用其他名称指向同一个函数对象，并访问访该函数：

```python
def sum(n):
	list = []
	for i in range(n):
		list.append(i)
	return list

s = sum
print(s(10))
```



没有 return 语句的函数返回值是 None （是一个内置名称）



## 函数默认参数

为参数指定默认值是非常有用的方式。调用函数时，可以使用比定义时更少的参数，例如：

```python
def sum(start,end,step=1,quantity=100):
	list = []
	while start < end and list.len() <= quantity:
		list.append(start)
		start = start + step
	return list
```



调用示例：

1. `sum(1,10)`只提供必须的参数
2. `sum(1,10,2)`，提供必须的参数和**部分**可选参数
3. `sum(1,10,1,5)`，提供所有参数（必须的参数和所有可选的参数）



## 关键词参数

kwarg=value 形式的 关键字参数 也可以用于调用函数。函数示例如下：、

```python
def sum(start,end,step=1,quantity=100):
	list = []
	while start < end and list.len() <= quantity:
		list.append(start)
		start = start + step
	return list
```



该函数接受两个必须参数和两个可选参数，以下是使用关键字参数调用的正确方法：

```python
sum(1,10)
sum(start=1,end=10)

sum(1,10,2)
sum(start=1,end=10,step=2)

sum(1,10,1,5)
sum(start=1,end=10,step=1,quantity=5)

sum(1,10,2)
sum(start=1,end=10,quantity=2)

sum(quantity=2,start=1,end=2,step=1)
```



以下调用函数的方式都无效：

```python
sum()
sum(quantity=2,1,10,2)
sum(1,quantity=2)
sum(1,10,ssttep=1)
sum(1,10,start=1)
```

- 函数调用时，关键字参数必须跟在位置参数后面；
- 所有传递的关键字参数都必须匹配一个函数接受的参数（比如，`ssttep` 不是函数 `sum` 的有效参数）；
- 关键字参数的顺序并不重要；
- 不能对同一个参数多次赋值。



