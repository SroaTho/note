# 正则表达式

正则表达式是正则表达式引擎尝试匹配输入文本的一种模式。 模式由一个或多个字符文本、运算符或构造组成。



## 元字符

元字符（Metacharacters）是在正则表达式中具有特殊意义的字符。

它们用于指定模式匹配的规则，而不是直接匹配文本中的某个字符。

| 元字符 | 描述                                                         |
| ------ | ------------------------------------------------------------ |
| `.`    | 匹配除换行符以外的任意单个字符。                             |
| `^`    | 匹配字符串的开始位置。如果在多行模式下，还可以匹配每一行的开始位置。 |
| `$`    | 匹配字符串的结束位置。同样地，在多行模式下，可以匹配每一行的结束位置。 |
| `*`    | 匹配前面的子表达式零次或多次。                               |
| `+`    | 匹配前面的子表达式一次或多次。                               |
| `?`    | 匹配前面的子表达式零次或一次，或指明一个非贪婪限定符         |
| `{}`   | 指定前面的子表达式的最小和最大重复次数，例如 `{2,4}` 表示匹配前面的子表达式至少两次，最多四次。 |
| `[]`   | 定义一个字符集，匹配括号内的任一字符。                       |
| `()`   | 定义一个子表达式或组，用于分组或捕获匹配的部分。             |
| `\`    | 转义符，用于取消下一个字符的特殊意义，或者用于表示某些特殊序列（如 `\d` 匹配任何数字，`\w` 匹配任何单词字符）。 |
| `|`    | 表示选择，用于指定多个可选项中的一个。                       |



## 字符类

一个字符类定义一组字符，其中的任一字符均可出现在输入字符串中以便成功匹配。



### 正字符组：[ ]

正字符组指定一个字符列表，其中的任何一个字符可出现在输入字符串中以便进行匹配。

此字符列表可以单独指定和/或作为范围指定。



#### 字符列表

用于指定各个字符列表的语法如下所示：

```
[character_group]
```

其中，character_group 是单个字符的列表，这些字符可出现在输入字符串中以便成功匹配。 

character_group 可以包含一个或多个文本字符、转义字符或字符类的任意组合。

示例：

```
[123789ABCXYZ]
```

![image-20241026164521120](./images/re%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.assets/image-20241026164521120.png)



#### 字符范围

用于指定字符范围的语法如下：

```
[firstCharacter-lastCharacter]
```

其中，*firstCharacter* 是范围的开始字符，*lastCharacter* 是范围的结束字符。 

字符范围是通过以下方式定义的一系列连续字符：

-  字符范围是通过以下方式定义的一系列连续字符：指定系列中的**第一个字符**，**连字符 (-)**，然后指定系列中的**最后一个字符**。

- 如果两个字符具有相邻的 Unicode 码位，则这两个字符是连续的。
-  firstCharacter 必须是码位较低的字符。
-  lastCharacter 必须是码位较高的字符。



> **注意**：如果连字符 `-` 出现在字符组的最开始或最末尾的位置，则它会被视为一个普通的字符，而不是范围分隔符，或者使用反斜杠 `\` 对其进行转义。
>
> - `[a-z-]` 匹配任何小写字母或连字符。
> - `[-a-z]` 同样匹配任何小写字母或连字符。
> - `[a\-z]` 在这里，连字符被转义，因此也匹配任何小写字母或连字符。



示例：

```
[0-9A-Z]
```

![image-20241026164806379](./images/re%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.assets/image-20241026164806379.png)



### 负字符组：[^]

负字符组指定一个字符列表，这些字符不得出现在输入字符串中以便进行匹配。 

此字符列表可以单独指定和/或作为范围指定。



#### 字符列表

用于指定各个字符列表的语法如下所示：

```
[^character_group]
```

*character_group* 是单个字符的列表，这些字符不可出现在输入字符串中以便成功匹配。

示例：

```
[^123ABCDEFGHJ]
```

![image-20241026165047422](./images/re%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.assets/image-20241026165047422.png)



#### 字符范围

用于指定字符范围的语法如下：

```
[^firstCharacter-lastCharacter]
```

其中，firstCharacter 是范围的开始字符，lastCharacter 是范围的结束字符。 

示例：

```
[^a-z0-5]
```

![image-20241026165140487](./images/re%20%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F.assets/image-20241026165140487.png)



### 字符类列表

| 字符类 | 描述                               | 模式   | 匹配                                                 |
| ------ | ---------------------------------- | ------ | ---------------------------------------------------- |
| `\w`   | 与任何**单词字符**匹配。           | `\w`   | `"ID A1.3"` 中的 `"I"`、`"D"`、`"A"`、`"1"` 和 `"3"` |
| `\W`   | 与任何**非单词字符**匹配。         | `\W`   | `"ID A1.3"` 中的 `" "` 和 `"."`                      |
| `\s`   | 与任何**空白**匹配。               | `\w\s` | `"ID A1.3"` 中的 `"D "`                              |
| `\S`   | 与任何**非空白字符**匹配。         | `\s\S` | `"a b_c"` 中的 `"a"`、`"b"`、`"_"`、`"c"`            |
| `\d`   | 与任何**十进制**数字匹配。         | `\d`   | `"4 = IV"` 中的 `"4"`                                |
| `\D`   | 与任何**不是十进制数**的字符匹配。 | `\D`   | `"4 = IV"` 中的 `" "`、`"="`、`" "`、`"I"` 和 `"V"`  |

**单词字符 (\w)**：匹配任何**字母、数字或下划线**。

**空白字符 (\s)**：匹配任何**空白字符，包括空格、制表符（Tab）、换行符等**。

**十进制数字 (\d)**：匹配任何**0-9之间的数字**。



### 非打印字符

| 字符 | 描述                                                         |
| :--- | :----------------------------------------------------------- |
| \cx  | 匹配由x指明的控制字符。例如， \cM 匹配一个 Control-M 或回车符。x 的值必须为 A-Z 或 a-z 之一。否则，将 c 视为一个原义的 'c' 字符。 |
| \f   | 匹配一个换页符。等价于 \x0c 和 \cL。                         |
| \n   | 匹配一个换行符。等价于 \x0a 和 \cJ。                         |
| \r   | 匹配一个回车符。等价于 \x0d 和 \cM。                         |



## 匹配的子表达式

以下分组构造捕获匹配的子表达式：

```
( subexpression )
```

此处，子表达式是任何有效的正则表达式模式。 

使用括号的捕获按正则表达式中左括号的顺序，从 1 开始，从左到右自动编号。 

命名的捕获组总是在非命名捕获组之后最后排序。 

编号为零的捕获是与整个**正则表达式模式匹配的文本**（将所有捕获的文本拼接）。





通过使用正则表达式中的反向引用构造。 使用语法 `\数字`在同一正则表达式中引用匹配的子表达式，其中 `数字` 是捕获的表达式的初始数字。

例如，如果你想匹配两个相同的单词，可以使用以下正则表达式：

```
\b(\w+)\b\s+\1\b
```

- `\b` 是单词边界。
- `(\w+)` 是第一个捕获组，匹配一个或多个单词字符。
- `\s+` 匹配一个或多个空白字符。
- `\1` 是对第一个捕获组的反向引用，确保第二个单词与第一个单词相同。





## 命名匹配的子表达式

以下分组构造捕获匹配的子表达式，并允许你按名称或编号访问它：

名称是有效的组名称，而子表达式是任何有效的正则表达式模式。 名称 不得包含任何标点符号字符，并且不能以数字开头。

```
(?<name>subexpression)
```

或：

```
(?'name'subexpression)
```





命名反向引用使用 `\k<name>` 的语法，在同一正则表达式中引用匹配的子表达式，其中 `name` 是捕获组的名称。命名捕获组使用 `(?<name>...)` 的语法定义。这使得代码更具可读性。

**示例 ：匹配两个相同的单词（使用命名捕获组）**

```
\b(?<word>\w+)\b\s+\k<word>\b
```

- `\b` 是单词边界。
- `(?<word>\w+)` 是一个命名捕获组，名称为 `word`，匹配一个或多个单词字符。
- `\s+` 匹配一个或多个空白字符。
- `\k<word>` 是对名为 `word` 的捕获组的反向引用，确保第二个单词与第一个单词相同。



